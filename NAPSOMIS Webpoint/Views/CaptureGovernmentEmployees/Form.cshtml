@model NAPSOMIS_Webpoint.ViewModels.CaptureMemRegViewModel
@using NAPSOMIS_Webpoint.ViewModels

@{
    ViewBag.Title = "Capture Government Employees Form";
}

<br />
<img src="~/Content/Images/view_pim_contacts.png" style="width:60px; height:50px; padding-left:10px;" />
<text style="color:midnightblue; padding-left:10px; font-size:larger;"> Capture Government Employees Form </text>
<br />
<text style="font-size:small; padding-left:10px;">Please fill the information below using the member form</text>

<script type="text/javascript">
    var lastprovince = null;
    function OnProvinceChanged(fprovince) {
        if (fdist.InCallback())
            lastprovince = fprovince.GetValue().toString();
        else
            fdist.PerformCallback(fprovince.GetValue().toString());
    }

    function OnEndCallback(s, e) {
        if (lastprovince) {
            fdist.PerformCallback(lastprovince);
            lastprovince = null;
        }
    }

    function OnBeginCallback(s, e) {
        e.customArgs["Province"] = fprovince.GetValue();

    }

    function OnEmpSelectedIndexChanged(s, e) {
        var employervalue = femp_name.GetText().split(";");
        //alert(employervalue[1]);
        //alert(femp_name.GetText());

        ferno.SetText(employervalue[0])
        femp_addr.SetText(employervalue[2]);
        //ftel_no.SetText(employervalue[3]);
    }

    function OnNationKeyDown(s, e) {
        if (ASPxClientUtils.GetKeyCode(e.htmlEvent) == 13) {
            fb_country.Focus()
        };
        if (fnation.GetText() == 'S') {
            fnation.SetText('SIERRA LEONEAN');
            fb_country.SetText('SIERRA LEONE')
        }
    }

    function OnNationFocus(s, e) {
        if (ASPxClientUtils.GetKeyCode(e.htmlEvent) == 13) {
            fb_country.Focus()
        };
        if (fnation.GetText() == 'S') {
            fnation.SetText('SIERRA LEONEAN');
            fb_country.SetText('SIERRA LEONE')
        }
    }

    function OnPrevButtonClick(s, e) {
        SetActiveTabByIndexIncrement(-1);
    }
    function OnNextButtonClick(s, e) {
        SetActiveTabByIndexIncrement(1);
    }

    function SetActiveTabByIndexIncrement(tabIndexIncrement) {
        var activeTabIndex = CaptureTab.GetActiveTab().index;
        activeTabIndex += tabIndexIncrement;
        CaptureTab.SetActiveTab(CaptureTab.GetTab(activeTabIndex));
    }

</script>


@using (Html.BeginForm("StartForm", "CaptureGovernmentEmployees", FormMethod.Post))
    {

    @Html.AntiForgeryToken()
    @Html.DevExpress().FormLayout(s =>
{

    s.Name = "StartCaptureGovernmetEmployees";
    s.ColCount = 3;
    //s.SettingsAdaptivity.AdaptivityMode = FormLayoutAdaptivityMode.SingleColumnWindowLimit;
    s.RequiredMark = "(*)";
    s.RequiredMarkDisplayMode = RequiredMarkMode.RequiredOnly;


    s.Items.Add(b => b.fref_no).NestedExtension().TextBox(p =>
    {
        p.Name = "fref_no_2";
        p.Properties.ClientSideEvents.KeyDown = "function(s,e){if(ASPxClientUtils.GetKeyCode(e.htmlEvent) == 13)cmdloadref.DoClick();}";

        p.Properties.HelpText = "Enter the Reference No here";
        p.Properties.HelpTextSettings.EnablePopupAnimation = true;
        p.Properties.HelpTextSettings.Position = HelpTextPosition.Top;
        p.Properties.HelpTextSettings.DisplayMode = HelpTextDisplayMode.Popup;

    });

    s.Items.Add(btn =>
    {
        btn.Caption = "";

        btn.NestedExtension().Button(b =>
        {
            b.Name = "cmdloadref";
            b.Text = "Load Data";
            b.UseSubmitBehavior = true;
            b.Width = Unit.Pixel(100);
        });

    });


}).GetHtml()

    }

@using (Html.BeginForm("Form", "CaptureGovernmentEmployees", FormMethod.Post))
    {

    @Html.AntiForgeryToken()
    @Html.DevExpress().FormLayout(s =>
{

    s.Name = "CaptureGovernmentForms";
    s.ColCount = 3;

    s.Items.AddTabbedGroupItem(group =>
    {
        group.ColSpan = 3;
        group.Name = "CaptureTab";

        group.Items.AddGroupItem(sb =>
        {
            sb.Caption = "Member Details";
            sb.Name = "firsttab";
            sb.ColSpan = 3;
            sb.ColCount = 3;

            sb.Items.AddGroupItem(g =>
            {
                g.Caption = "Name";
                g.GroupBoxDecoration = GroupBoxDecoration.HeadingLine;
                g.ColSpan = 3;
                g.ColCount = 3;


                g.Items.Add(m => m.fref_no).NestedExtension().TextBox(b => { b.ReadOnly = true; });
                g.Items.Add(m => m.fsurname).NestedExtension().TextBox(b => { b.ReadOnly = true; });
                g.Items.Add(m => m.firstname).NestedExtension().TextBox(b => { b.ReadOnly = true; });
                g.Items.Add(m => m.fothname).NestedExtension().TextBox(b => { b.ReadOnly = true; });
                g.Items.Add(m => m.fb_date).NestedExtension().DateEdit(b => { b.ReadOnly = true; });

            });

            sb.Items.AddGroupItem(g =>
            {
                g.Caption = "Previous Name";
                g.GroupBoxDecoration = GroupBoxDecoration.HeadingLine;
                g.ColSpan = 3;
                g.ColCount = 3;


                g.Items.Add(m => m.fpsurname).NestedExtension().TextBox(b => { b.Name = "fpsurname"; b.ReadOnly = false; });
                g.Items.Add(m => m.fpfirstname).NestedExtension().TextBox(b => { b.Name = "fpfirstname"; b.ReadOnly = false; });
                g.Items.Add(m => m.fpothname).NestedExtension().TextBox(b => { b.Name = "fpothname"; b.ReadOnly = false; });

            });

            sb.Items.AddGroupItem(g =>
            {
                g.Caption = "Details";
                g.GroupBoxDecoration = GroupBoxDecoration.Box;
                g.ColSpan = 3;
                g.ColCount = 3;

                g.Items.Add(m => m.fper_addr).NestedExtension().Memo(b =>
                {
                    b.Name = "fper_addr";
                    b.Height = 70;
                    b.Properties.CaptionSettings.Position = EditorCaptionPosition.Top;
                    b.Properties.CaptionSettings.VerticalAlign = EditorCaptionVerticalAlign.Top;
                    b.Properties.ClientSideEvents.KeyDown = "function(s,e){if(ASPxClientUtils.GetKeyCode(e.htmlEvent) == 13)fcur_addr.Focus();}";
                    b.Properties.ClientSideEvents.TextChanged = "function(s,e){fcur_addr.SetText(fper_addr.GetText());}";

                    b.Properties.HelpText = "Enter the Permanent Address of the Member here";
                    b.Properties.HelpTextSettings.EnablePopupAnimation = true;
                    b.Properties.HelpTextSettings.Position = HelpTextPosition.Top;
                    b.Properties.HelpTextSettings.DisplayMode = HelpTextDisplayMode.Popup;

                });

                g.Items.Add(m => m.fcur_addr).NestedExtension().Memo(b =>
                {
                    b.Name = "fcur_addr";
                    b.Height = 70;
                    b.Properties.ClientSideEvents.KeyDown = "function(s,e){if(ASPxClientUtils.GetKeyCode(e.htmlEvent) == 13)fm_stat.Focus();}";

                    b.Properties.HelpText = "Enter the Current Address of the Member here";
                    b.Properties.HelpTextSettings.EnablePopupAnimation = true;
                    b.Properties.HelpTextSettings.Position = HelpTextPosition.Top;
                    b.Properties.HelpTextSettings.DisplayMode = HelpTextDisplayMode.Popup;

                });

                g.Items.Add(m => m.fm_stat).NestedExtension().ComboBox(b =>
                {
                    b.Name = "fm_stat";
                    b.Properties.Items.Add("Married", "M");
                    b.Properties.Items.Add("Single", "S");
                    b.Properties.Items.Add("Widowed", "W");
                    b.Properties.Items.Add("Divorced", "D");
                    b.Properties.ClientSideEvents.KeyDown = "function(s,e){if(ASPxClientUtils.GetKeyCode(e.htmlEvent) == 13)fnation.Focus();}";
                });

                g.Items.Add(m => m.fnation).NestedExtension().TextBox(b =>
                {
                    b.Name = "fnation";
                    //b.Properties.ClientSideEvents.KeyDown = "function(s,e){if(e.htmlEvent.keycode == ASPxKey.Enter)fb_country.Focus();}";
                    b.Properties.ClientSideEvents.KeyDown = "OnNationKeyDown";
                    b.Properties.ClientSideEvents.GotFocus = "OnNationFocus";
                });

                g.Items.Add(m => m.fb_country).NestedExtension().TextBox(b =>
                {
                    b.Name = "fb_country";
                    b.Properties.ClientSideEvents.KeyDown = "function(s,e){if(ASPxClientUtils.GetKeyCode(e.htmlEvent) == 13)fsex.Focus();}";

                    b.Properties.HelpText = "Specify the Courty of Birth Here";
                    b.Properties.HelpTextSettings.EnablePopupAnimation = true;
                    b.Properties.HelpTextSettings.Position = HelpTextPosition.Top;
                    b.Properties.HelpTextSettings.DisplayMode = HelpTextDisplayMode.Popup;

                });


                g.Items.Add(m => m.fsex).NestedExtension().RadioButtonList(b =>
                {
                    b.Name = "fsex";
                    b.Properties.Items.Add("Male", "M");
                    b.Properties.Items.Add("Female", "F");
                    
                });

            });

            sb.Items.AddGroupItem(g =>
            {
                g.Caption = "Place of Birth";
                g.GroupBoxDecoration = GroupBoxDecoration.Box;
                g.ColSpan = 3;
                g.ColCount = 3;

                g.Items.Add(m => m.fprovince).NestedExtension().ComboBox(b =>
                {
                    b.Name = "fprovince";

                    List<PDCTemplate> myprovinces = (List<PDCTemplate>)TempData.Peek("MyProvinces");

                    b.Properties.Columns.Add("Code", "Code", Unit.Pixel(50));
                    b.Properties.Columns.Add("Name", "Name", Unit.Pixel(200));

                    b.Properties.DataSource = myprovinces;
                    b.Properties.TextField = "Name";
                    b.Properties.ValueField = "Code";

                    b.Properties.IncrementalFilteringMode = IncrementalFilteringMode.Contains;

                    b.Properties.ClientSideEvents.KeyDown = "function(s,e){if(ASPxClientUtils.GetKeyCode(e.htmlEvent) == 13)fdist.Focus();}";
                    //b.Properties.ClientSideEvents.SelectedIndexChanged = "function(s,e){fdist.PerformCallback(fprovince.GetValue())}";
                });

                g.Items.Add(m => m.fdist).NestedExtension().ComboBox(b =>
                {
                    b.Name = "fdist";
                    List<PDCTemplate> mydistrict = (List<PDCTemplate>)TempData.Peek("MyDistricts");

                    b.Properties.Columns.Add("Code", "Code", Unit.Pixel(50));
                    b.Properties.Columns.Add("Name", "Name", Unit.Pixel(200));

                    b.Properties.DataSource = mydistrict;
                    b.Properties.TextField = "Name";
                    b.Properties.ValueField = "Code";

                    b.Properties.IncrementalFilteringMode = IncrementalFilteringMode.StartsWith;

                    //b.CallbackRouteValues = new { Controller = "CaptureGovernmetEmployees", Action = "FilterDistrict" };
                    //b.Properties.CallbackPageSize = 30;

                    b.Properties.ClientSideEvents.KeyDown = "function(s,e){if(ASPxClientUtils.GetKeyCode(e.htmlEvent) == 13)fchief.Focus();}";
                    //b.Properties.ClientSideEvents.BeginCallback = "OnBeginCallback";

                });


                g.Items.Add(m => m.fchief).NestedExtension().ComboBox(b =>
                {
                    b.Name = "fchief";
                    List<PDCTemplate> mychiefdom = (List<PDCTemplate>)TempData.Peek("MyChiefdoms");

                    b.Properties.Columns.Add("Code", "Code", Unit.Pixel(50));
                    b.Properties.Columns.Add("Name", "Name", Unit.Pixel(200));

                    b.Properties.DataSource = mychiefdom;
                    b.Properties.TextField = "Name";
                    b.Properties.ValueField = "Code";
                    b.Properties.IncrementalFilteringMode = IncrementalFilteringMode.StartsWith;

                    b.Properties.ClientSideEvents.KeyDown = "function(s,e){if(ASPxClientUtils.GetKeyCode(e.htmlEvent) == 13)ftown.Focus();}";
                });

                g.Items.Add(m => m.ftown).NestedExtension().TextBox(b =>
                {
                    b.Name = "ftown";
                    b.Properties.ClientSideEvents.KeyDown = "function(s,e){if(ASPxClientUtils.GetKeyCode(e.htmlEvent) == 13)fgen_date.Focus();}";
                });

            });


            sb.Items.Add(m => m.fjoindate).NestedExtension().DateEdit(b =>
            {
                b.Name = "fjoindate";
                b.ReadOnly = true;
                b.Properties.ClientSideEvents.KeyDown = "function(s,e){if(ASPxClientUtils.GetKeyCode(e.htmlEvent) == 13)fnat_income.Focus();}";

            });

            sb.Items.Add(m => m.fnat_income).NestedExtension().RadioButtonList(m =>
            {
                m.Name = "fnat_income";
                m.SelectedIndex = 1;
                m.Properties.Items.Add("Daily", "1");
                m.Properties.Items.Add("Monthly", "2");
                m.Properties.Items.Add("Yearly", "3");

             });

            sb.Items.Add(m => m.fincome).NestedExtension().TextBox(m =>
            {
                m.Name = "fincome";
                m.Properties.DisplayFormatString = "C2";

                m.Properties.ClientSideEvents.KeyDown = "function(s,e){if(ASPxClientUtils.GetKeyCode(e.htmlEvent) == 13)foccupation.Focus();}";
            });

            sb.Items.Add(m => m.foccupation).NestedExtension().ComboBox(b =>
            {

                b.Name = "foccupation";

                List<PDCTemplate> myoccupations = (List<PDCTemplate>)TempData.Peek("MyOccupations");

                b.Properties.Columns.Add("Code", "Code", Unit.Pixel(50));
                b.Properties.Columns.Add("Name", "Name", Unit.Pixel(250));

                b.Properties.DataSource = myoccupations;
                b.Properties.TextField = "Name";
                b.Properties.ValueField = "Code";

                //b.Properties.IncrementalFilteringMode = IncrementalFilteringMode.None;

                b.Properties.ClientSideEvents.KeyDown = "function(s,e){if(ASPxClientUtils.GetKeyCode(e.htmlEvent) == 13)ffsurname.Focus();}";
            });

            sb.Items.AddGroupItem(g =>
            {
                g.Name = "fathergroup";
                g.Caption = "Father";
                g.ColSpan = 3;
                g.ColCount = 3;
                g.GroupBoxDecoration = GroupBoxDecoration.Box;

                g.Items.Add(m => m.ffsurname).NestedExtension().TextBox(b =>
                {
                    b.Name = "ffsurname";
                    b.Properties.ClientSideEvents.KeyDown = "function(s,e){if(ASPxClientUtils.GetKeyCode(e.htmlEvent) == 13)ffirstname.Focus();}";
                });

                g.Items.Add(m => m.ffirstname).NestedExtension().TextBox(b =>
                {
                    b.Name = "ffirstname";
                    b.Properties.ClientSideEvents.KeyDown = "function(s,e){if(ASPxClientUtils.GetKeyCode(e.htmlEvent) == 13)ffothname.Focus();}";
                });

                g.Items.Add(m => m.ffothname).NestedExtension().TextBox(b =>
                {
                    b.Name = "ffothname";
                    b.Properties.ClientSideEvents.KeyDown = "function(s,e){if(ASPxClientUtils.GetKeyCode(e.htmlEvent) == 13)fmsurname.Focus();}";
                });

            });


            sb.Items.AddGroupItem(g =>
            {
                g.Name = "mothergroup";
                g.Caption = "Mother";
                g.ColSpan = 3;
                g.ColCount = 3;
                g.GroupBoxDecoration = GroupBoxDecoration.Box;

                g.Items.Add(m => m.fmsurname).NestedExtension().TextBox(b =>
                {
                    b.Name = "fmsurname";
                    b.Properties.ClientSideEvents.KeyDown = "function(s,e){if(ASPxClientUtils.GetKeyCode(e.htmlEvent) == 13)fmfirstname.Focus();}";
                });

                g.Items.Add(m => m.fmfirstname).NestedExtension().TextBox(b =>
                {
                    b.Name = "fmfirstname";
                    b.Properties.ClientSideEvents.KeyDown = "function(s,e){if(ASPxClientUtils.GetKeyCode(e.htmlEvent) == 13)fmothname.Focus();}";
                });

                g.Items.Add(m => m.fmothname).NestedExtension().TextBox(b =>
                {
                    b.Name = "fmothname";
                    b.Properties.ClientSideEvents.KeyDown = "function(s,e){if(ASPxClientUtils.GetKeyCode(e.htmlEvent) == 13)ferno.Focus();}";
                });


            });

        });


        group.Items.AddGroupItem(sb =>
        {
            sb.Caption = "Employer";
            sb.Name = "secondtab";

            sb.ColSpan = 3;
            sb.ColCount = 3;
            sb.GroupBoxDecoration = GroupBoxDecoration.HeadingLine;

            sb.Items.Add(m => m.ferno).NestedExtension().TextBox(b =>
            {
                b.Name = "ferno";
                //b.Properties.ClientSideEvents.TextChanged = "function(s,e){alert(femp_name.SetValue(ferno.GetText());}";
                b.Properties.ClientSideEvents.KeyDown = "function(s,e){if(ASPxClientUtils.GetKeyCode(e.htmlEvent) == 13)femp_name.Focus();}";
                b.Properties.ClientSideEvents.TextChanged = "function(s,e){combobox.SetValue(ferno.GetText());}";
            });

            sb.Items.Add(m => m.femp_name).NestedExtension().ComboBox(b =>
            {
                b.Name = "femp_name";

                List<EmployerTemplate> myemployers = (List<EmployerTemplate>)TempData.Peek("MyEmployers");

                b.Properties.Columns.Add("Code", "Code", Unit.Pixel(100));
                b.Properties.Columns.Add("Name", "Name", Unit.Pixel(350));
                b.Properties.Columns.Add("Address", "Address", Unit.Pixel(350));
                b.Properties.Columns.Add("TelNo", "Tel No", Unit.Pixel(100));

                b.Properties.DataSource = myemployers;
                b.Properties.TextField = "Name";
                b.Properties.ValueField = "Name";
                b.Properties.ShowShadow = true;
                b.Properties.AnimationType = AnimationType.Slide;

                b.Properties.IncrementalFilteringMode = IncrementalFilteringMode.StartsWith;
                b.Properties.ClientSideEvents.SelectedIndexChanged = "OnEmpSelectedIndexChanged";
                b.Properties.ClientSideEvents.KeyDown = "function(s,e){if(ASPxClientUtils.GetKeyCode(e.htmlEvent) == 13)femp_addr.Focus();}";

            });

            sb.Items.Add(m => m.femp_addr).NestedExtension().TextBox(b =>
            {
                b.Name = "femp_addr";
                b.Properties.ClientSideEvents.KeyDown = "function(s,e){if(ASPxClientUtils.GetKeyCode(e.htmlEvent) == 13)ftel_no.Focus();}";
            });

            sb.Items.Add(m => m.ftel_no).NestedExtension().TextBox(b =>
            {
                b.Name = "ftel_no";
                b.Properties.ClientSideEvents.KeyDown = "function(s,e){if(ASPxClientUtils.GetKeyCode(e.htmlEvent) == 13)cmdappend.DoClick();}";
            });

            sb.Items.Add(m => m.fstaffno).NestedExtension().TextBox(b =>
            {
                b.Name = "fstaffno";
                b.Properties.ClientSideEvents.KeyDown = "function(s,e){if(ASPxClientUtils.GetKeyCode(e.htmlEvent) == 13)cmdappend.DoClick();}";
            });

            sb.Items.Add(m => m.fstatus).NestedExtension().TextBox(b =>
            {
                b.Name = "fstatus";
                b.Properties.ClientSideEvents.KeyDown = "function(s,e){if(ASPxClientUtils.GetKeyCode(e.htmlEvent) == 13)cmdappend.DoClick();}";
            });

        });


        group.Items.AddGroupItem(sb =>
        {
            sb.Caption = "Member's Dependants";
            sb.Name = "thirdtab";
            sb.ColSpan = 3;
            sb.ColCount = 3;
            sb.ShowCaption = DefaultBoolean.False;

            sb.Items.Add(i =>
            {
                i.Caption = " ";
                i.NestedExtension().Button(b =>
                {
                    b.Name = "cmdappend";
                    b.Text = "Add Member Dependants";
                    b.UseSubmitBehavior = true;
                    b.Width = Unit.Pixel(100);

                });
            });


        });

    });

    s.Items.AddGroupItem(sb =>
    {
        sb.ColSpan = 3;
        sb.ColCount = 3;
        sb.Caption = "";
        sb.GroupBoxDecoration = GroupBoxDecoration.None;

        sb.ShowCaption = DefaultBoolean.False;
        sb.Paddings.PaddingBottom = 6;
        sb.Paddings.PaddingLeft = 0;
        sb.Paddings.PaddingTop = 5; 
        sb.UseDefaultPaddings = false;

        sb.Name = "cleargroup";
        sb.Items.Add(i =>
        {
            i.Caption = " ";
            i.NestedExtension().Button(b =>
            {
                b.Name = "clear";
                b.Text = "Start New Entry";
                b.UseSubmitBehavior = false;
                b.Width = Unit.Pixel(100);
                b.RouteValues = new { Controller = "CaptureGovernmentEmployees", Action = "Form", ParamValue = "" };
            });
        });


        sb.Items.Add(i =>
        {
            i.ShowCaption = DefaultBoolean.False;
            i.Caption = " ";
            i.NestedExtension().Button(b =>
            {
                b.Name = "cmdnextgroup";
                b.Text = "<< Previous";
                b.UseSubmitBehavior = false;
                b.Width = Unit.Pixel(100);
                //b.RouteValues = new { Controller = "CaptureRegistrationForms", Action = "CaptureRegistrationForms", ParamValue = "" };
                b.ClientSideEvents.Click = "OnPrevButtonClick";
            });
        });


        sb.Items.Add(i =>
        {
            i.ShowCaption = DefaultBoolean.False;

            i.Caption = " ";
            i.NestedExtension().Button(b =>
            {
                b.Name = "cmdnexttab";
                b.Text = ">> Next";
                b.UseSubmitBehavior = false;
                b.Width = Unit.Pixel(100);
                //b.RouteValues = new { Controller = "CaptureRegistrationForms", Action = "CaptureRegistrationForms", ParamValue = "" };
                b.ClientSideEvents.Click = "OnNextButtonClick";
            });
        });



    });

}).GetHtml()

    }